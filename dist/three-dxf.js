!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("THREE")):"function"==typeof define&&define.amd?define(["THREE"],t):"object"==typeof exports?exports.ThreeDxf=t(require("THREE")):e.ThreeDxf=t(e.THREE)}(self,(function(e){return(()=>{"use strict";var t={831:(e,t,o)=>{o.r(t),o.d(t,{Viewer:()=>f});var n=o(428);function r(e,t){this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.target=new n.Vector3,this.center=this.target,this.noZoom=!1,this.zoomSpeed=1,this.minDistance=0,this.maxDistance=1/0,this.noRotate=!1,this.rotateSpeed=1,this.noPan=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.noKeys=!1,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40};var o=this,r=new n.Vector2,i=new n.Vector2,s=new n.Vector2,p=new n.Vector2,a=new n.Vector2,c=new n.Vector2,l=new n.Vector3,h=new n.Vector3,u=new n.Vector2,d=new n.Vector2,y=new n.Vector2,m=1,f=new n.Vector3,v=(new n.Vector3,-1),x=v;this.target0=this.target.clone(),this.position0=this.object.position.clone();var b={type:"change"},g={type:"start"},w={type:"end"};function E(){return 2*Math.PI/60/60*o.autoRotateSpeed}function P(){return Math.pow(.95,o.zoomSpeed)}function j(e){if(!1!==o.enabled){e.preventDefault();var t=o.domElement===document?o.domElement.body:o.domElement;if(0===x){if(!0===o.noRotate)return;i.set(e.clientX,e.clientY),s.subVectors(i,r),o.rotateLeft(2*Math.PI*s.x/t.clientWidth*o.rotateSpeed),o.rotateUp(2*Math.PI*s.y/t.clientHeight*o.rotateSpeed),r.copy(i)}else if(1===x){if(!0===o.noZoom)return;d.set(e.clientX,e.clientY),y.subVectors(d,u),y.y>0?o.dollyIn():o.dollyOut(),u.copy(d)}else if(2===x){if(!0===o.noPan)return;a.set(e.clientX,e.clientY),c.subVectors(a,p),o.pan(c.x,c.y),p.copy(a)}o.update()}}function M(){!1!==o.enabled&&(o.domElement.removeEventListener("mousemove",j,!1),o.domElement.removeEventListener("mouseup",M,!1),o.dispatchEvent(w),x=v)}function O(e){if(!1!==o.enabled&&!0!==o.noZoom){e.preventDefault();var t=0;void 0!==e.wheelDelta?t=e.wheelDelta:void 0!==e.detail&&(t=-e.detail),t>0?o.dollyOut():o.dollyIn(),o.update(),o.dispatchEvent(g),o.dispatchEvent(w)}}this.rotateLeft=function(e){void 0===e&&(e=E())},this.rotateUp=function(e){void 0===e&&(e=E())},this.panLeft=function(e){var t=this.object.matrix.elements;l.set(t[0],t[1],t[2]),l.multiplyScalar(-e),f.add(l)},this.panUp=function(e){var t=this.object.matrix.elements;l.set(t[4],t[5],t[6]),l.multiplyScalar(e),f.add(l)},this.pan=function(e,t){var n=o.domElement===document?o.domElement.body:o.domElement;if(void 0!==o.object.fov){var r=o.object.position.clone().sub(o.target).length();r*=Math.tan(o.object.fov/2*Math.PI/180),o.panLeft(2*e*r/n.clientHeight),o.panUp(2*t*r/n.clientHeight)}else void 0!==o.object.top?(o.panLeft(e*(o.object.right-o.object.left)/n.clientWidth),o.panUp(t*(o.object.top-o.object.bottom)/n.clientHeight)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")},this.dollyIn=function(e){void 0===e&&(e=P()),m/=e},this.dollyOut=function(e){void 0===e&&(e=P()),m*=e},this.update=function(){void 0!==o.object.top&&(this.object.top=m*this.object.top,this.object.bottom=m*this.object.bottom,this.object.left=m*this.object.left,this.object.right=m*this.object.right,this.object.updateProjectionMatrix());var e=this.object.position;h.copy(e).sub(this.target),this.target.add(f),e.copy(this.target).add(h),this.object.lookAt(this.target),this.dispatchEvent(b),m=1,f.set(0,0,0)},this.reset=function(){x=v,this.target.copy(this.target0),this.object.position.copy(this.position0),this.update()},this.domElement.addEventListener("contextmenu",(function(e){e.preventDefault()}),!1),this.domElement.addEventListener("mousedown",(function(e){if(!1!==o.enabled){if(e.preventDefault(),0===e.button){if(!0===o.noRotate)return;x=0,r.set(e.clientX,e.clientY)}else if(1===e.button){if(!0===o.noZoom)return;x=1,u.set(e.clientX,e.clientY)}else if(2===e.button){if(!0===o.noPan)return;x=2,p.set(e.clientX,e.clientY)}o.domElement.addEventListener("mousemove",j,!1),o.domElement.addEventListener("mouseup",M,!1),o.dispatchEvent(g)}}),!1),this.domElement.addEventListener("mousewheel",O,!1),this.domElement.addEventListener("DOMMouseScroll",O,!1),this.domElement.addEventListener("touchstart",(function(e){if(!1!==o.enabled){switch(e.touches.length){case 1:if(!0===o.noRotate)return;x=3,r.set(e.touches[0].pageX,e.touches[0].pageY);break;case 2:if(!0===o.noZoom)return;x=4;var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,i=Math.sqrt(t*t+n*n);u.set(0,i);break;case 3:if(!0===o.noPan)return;x=5,p.set(e.touches[0].pageX,e.touches[0].pageY);break;default:x=v}o.dispatchEvent(g)}}),!1),this.domElement.addEventListener("touchend",(function(){!1!==o.enabled&&(o.dispatchEvent(w),x=v)}),!1),this.domElement.addEventListener("touchmove",(function(e){if(!1!==o.enabled){e.preventDefault(),e.stopPropagation();var t=o.domElement===document?o.domElement.body:o.domElement;switch(e.touches.length){case 1:if(!0===o.noRotate)return;if(3!==x)return;i.set(e.touches[0].pageX,e.touches[0].pageY),s.subVectors(i,r),o.rotateLeft(2*Math.PI*s.x/t.clientWidth*o.rotateSpeed),o.rotateUp(2*Math.PI*s.y/t.clientHeight*o.rotateSpeed),r.copy(i),o.update();break;case 2:if(!0===o.noZoom)return;if(4!==x)return;var n=e.touches[0].pageX-e.touches[1].pageX,l=e.touches[0].pageY-e.touches[1].pageY,h=Math.sqrt(n*n+l*l);d.set(0,h),y.subVectors(d,u),y.y>0?o.dollyOut():o.dollyIn(),u.copy(d),o.update();break;case 3:if(!0===o.noPan)return;if(5!==x)return;a.set(e.touches[0].pageX,e.touches[0].pageY),c.subVectors(a,p),o.pan(c.x,c.y),p.copy(a),o.update();break;default:x=v}}}),!1),window.addEventListener("keydown",(function(e){if(!1!==o.enabled&&!0!==o.noKeys&&!0!==o.noPan)switch(e.keyCode){case o.keys.UP:o.pan(0,o.keyPanSpeed),o.update();break;case o.keys.BOTTOM:o.pan(0,-o.keyPanSpeed),o.update();break;case o.keys.LEFT:o.pan(o.keyPanSpeed,0),o.update();break;case o.keys.RIGHT:o.pan(-o.keyPanSpeed,0),o.update()}}),!1)}r.prototype=Object.create(n.EventDispatcher.prototype);const i=r;function s(e,t){if(null==e)return{};var o,n,r=function(e,t){if(null==e)return{};var o,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)o=i[n],t.indexOf(o)>=0||(r[o]=e[o]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)o=i[n],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(r[o]=e[o])}return r}function p(e,t){if(null==e)return{};var o,n,r=function(e,t){if(null==e)return{};var o,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)o=i[n],t.indexOf(o)>=0||(r[o]=e[o]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)o=i[n],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(r[o]=e[o])}return r}var a=function(e,t){var o=new n.Vector2(e.x,e.y),r=new n.Vector2(t.x,t.y);return r.sub(o),r.normalize(),r.y<0?-Math.acos(r.x):Math.acos(r.x)},c=function(e,t,o){return{x:e.x+t*Math.cos(o),y:e.y+t*Math.sin(o)}};function l(e,t,o,r){n.Geometry.call(this);var i=this.startPoint=e?new n.Vector2(e.x,e.y):new n.Vector2(0,0),s=this.endPoint=t?new n.Vector2(t.x,t.y):new n.Vector2(1,0);this.bulge=o=o||1;var p=4*Math.atan(o),l=i.distanceTo(s)/2/Math.sin(p/2),h=c(e,l,a(i,s)+(Math.PI/2-p/2));this.segments=r=r||Math.max(Math.abs(Math.ceil(p/(Math.PI/18))),6);var u=a(h,i),d=p/r;this.vertices.push(new n.Vector3(i.x,i.y,0));for(var y=1;y<=r-1;y++){var m=c(h,Math.abs(l),u+d*y);this.vertices.push(new n.Vector3(m.x,m.y,0))}}l.prototype=Object.create(n.Geometry.prototype);const h=l;function u(e,t){return this.type=e,this.props=t,this.entity=this.draw(),this}u.prototype.source=null,u.prototype.font=null,u.prototype.scene=null,u.prototype.getColor=function(){var e=0;return this.props.color?e=this.props.color:this.source.tables&&this.source.tables.layer&&this.source.tables.layer.layers[this.props.layer]&&(e=this.source.tables.layer.layers[this.props.layer].color),null!=e&&16777215!==e||(e=0),e},u.prototype.draw=function(){switch(this.type){case"CIRCLE":case"ARC":return function(e){var t,o;"CIRCLE"===e.type?o=(t=e.props.startAngle||0)+2*Math.PI:(t=e.props.startAngle,o=e.props.endAngle);var r=new n.ArcCurve(0,0,e.props.radius,t,o).getPoints(32),i=(new n.BufferGeometry).setFromPoints(r),s=new n.LineBasicMaterial({color:e.getColor()}),p=new n.Line(i,s);return p.position.x=e.props.center.x,p.position.y=e.props.center.y,p.position.z=e.props.center.z,p}(this);case"POLYLINE":case"LWPOLYLINE":case"LINE":return function(e){var t,o=new n.Geometry,r=e.getColor();if(!e.props.vertices)return console.log("entity missing vertices.");for(var i=0;i<e.props.vertices.length;i++)if(e.props.vertices[i].bulge){var s=e.props.vertices[i].bulge,p=e.props.vertices[i],a=i+1<e.props.vertices.length?e.props.vertices[i+1]:o.vertices[0],c=new h(p,a,s);o.vertices.push.apply(o.vertices,c.vertices)}else{var l=e.props.vertices[i];o.vertices.push(new n.Vector3(l.x,l.y,0))}e.props.shape&&o.vertices.push(o.vertices[0]),e.props.lineType&&(t=e.source.tables.lineType.lineTypes[e.props.lineType]);var u=t&&t.pattern&&0!==t.pattern.length?new n.LineDashedMaterial({color:r,gapSize:4,dashSize:4}):new n.LineBasicMaterial({linewidth:1,color:r});return new n.Line(o,u)}(this);case"TEXT":return function(e){if(!e.font)return console.warn("Text is not supported without a Three.js font loaded with THREE.FontLoader! Load a font of your choice and pass this into the constructor. See the sample for this repository or Three.js examples at http://threejs.org/examples/?q=text#webgl_geometry_text for more details.");var t=new n.TextGeometry(e.props.text,{font:e.font,height:0,size:e.props.textHeight||12});if(e.props.rotation){var o=e.props.rotation*Math.PI/180;t.rotateZ(o)}var r=new n.MeshBasicMaterial({color:e.getColor()}),i=new n.Mesh(t,r);return i.position.x=e.props.startPoint.x,i.position.y=e.props.startPoint.y,i.position.z=e.props.startPoint.z,i}(this);case"SOLID":return function(e){var t=new n.Geometry,o=t.vertices;o.push(new n.Vector3(e.props.points[0].x,e.props.points[0].y,e.props.points[0].z)),o.push(new n.Vector3(e.props.points[1].x,e.props.points[1].y,e.props.points[1].z)),o.push(new n.Vector3(e.props.points[2].x,e.props.points[2].y,e.props.points[2].z)),o.push(new n.Vector3(e.props.points[3].x,e.props.points[3].y,e.props.points[3].z));var r=new n.Vector3,i=new n.Vector3;r.subVectors(o[1],o[0]),i.subVectors(o[2],o[0]),r.cross(i),r.z<0?(t.faces.push(new n.Face3(2,1,0)),t.faces.push(new n.Face3(2,3,1))):(t.faces.push(new n.Face3(0,1,2)),t.faces.push(new n.Face3(1,3,2)));var s=new n.MeshBasicMaterial({color:e.getColor()});return new n.Mesh(t,s)}(this);case"POINT":return function(e){e.scene;var t=new n.Geometry;t.vertices.push(new n.Vector3(e.props.position.x,e.props.position.y,e.props.position.z));var o=e.getColor(),r=new Float32Array(3);r[0]=o.r,r[1]=o.g,r[2]=o.b,t.colors=r,t.computeBoundingBox();var i=new n.PointsMaterial({size:.05,vertexColors:n.VertexColors});return new n.Points(t,i)}(this);case"INSERT":return function(e){var t=e.source.blocks[e.props.name];if(!t.entities)return null;var o=new n.Object3D;e.props.xScale&&(o.scale.x=e.props.xScale),e.props.yScale&&(o.scale.y=e.props.yScale),e.props.rotation&&(o.rotation.z=e.props.rotation*Math.PI/180),e.props.position&&(o.position.x=e.props.position.x,o.position.y=e.props.position.y,o.position.z=e.props.position.z);for(var r=0;r<t.entities.length;r++){var i=t.entities[r],p=i.type,a=s(i,["type"]),c=new d(p,a).entity;c&&o.add(c)}return o}(this);case"SPLINE":return function(e){var t,o=e.getColor(),r=e.props.controlPoints.map((function(e){return new n.Vector2(e.x,e.y)})),i=[];if(2===e.props.degreeOfSplineCurve||3===e.props.degreeOfSplineCurve){var s=0;for(s=0;s+2<r.length;s+=2)t=2===e.props.degreeOfSplineCurve?new n.QuadraticBezierCurve(r[s],r[s+1],r[s+2]):new n.QuadraticBezierCurve3(r[s],r[s+1],r[s+2]),i.push.apply(i,t.getPoints(50));s<r.length&&(t=new n.QuadraticBezierCurve3(r[s],r[s+1],r[s+1]),i.push.apply(i,t.getPoints(50)))}else t=new n.SplineCurve(r),function(e){throw new TypeError('"interpolatedPoints" is read-only')}(),i=t.getPoints(100);var p=(new n.BufferGeometry).setFromPoints(i),a=new n.LineBasicMaterial({linewidth:1,color:o});return new n.Line(p,a)}(this);case"MTEXT":return function(e){var t=e.getColor();if(!e.font)return console.log("font parameter not set. Ignoring text entity.");var o=new n.TextGeometry(e.props.text,{font:e.font,size:.8*e.props.height,height:1}),r=new n.MeshBasicMaterial({color:t}),i=new n.Mesh(o,r),s=new n.Box3;s.setFromObject(i);var p=s.max.x-s.min.x;if(!(p>e.props.width)){switch(i.position.z=0,e.props.attachmentPoint){case 1:i.position.x=e.props.position.x,i.position.y=e.props.position.y-e.props.height;break;case 2:i.position.x=e.props.position.x-p/2,i.position.y=e.props.position.y-e.props.height;break;case 3:i.position.x=e.props.position.x-p,i.position.y=e.props.position.y-e.props.height;break;case 4:i.position.x=e.props.position.x,i.position.y=e.props.position.y-e.props.height/2;break;case 5:i.position.x=e.props.position.x-p/2,i.position.y=e.props.position.y-e.props.height/2;break;case 6:i.position.x=e.props.position.x-p,i.position.y=e.props.position.y-e.props.height/2;break;case 7:i.position.x=e.props.position.x,i.position.y=e.props.position.y;break;case 8:i.position.x=e.props.position.x-p/2,i.position.y=e.props.position.y;break;case 9:i.position.x=e.props.position.x-p,i.position.y=e.props.position.y;break;default:return}return i}console.log("Can't render this multipline MTEXT entity, sorry.",e)}(this);case"ELLIPSE":return o=(t=this).getColor(),r=Math.sqrt(Math.pow(t.props.majorAxisEndPoint.x,2)+Math.pow(t.props.majorAxisEndPoint.y,2)),i=r*t.props.axisRatio,a=Math.atan2(t.props.majorAxisEndPoint.y,t.props.majorAxisEndPoint.x),c=new n.EllipseCurve(t.props.center.x,t.props.center.y,r,i,t.props.startAngle,t.props.endAngle,!1,a).getPoints(50),l=(new n.BufferGeometry).setFromPoints(c),u=new n.LineBasicMaterial({linewidth:1,color:o}),new n.Line(l,u);case"DIMENSION":var e=7&this.props.dimensionType;if(0===e)return function(e){var t=e.source.blocks[e.props.block];if(!t||!t.entities)return null;for(var o=new THREE.Object3D,n=0;n<t.entities.length;n++){var r=t.entities[n],i=r.type,s=p(r,["type"]),a=new d(i,s).entity;a&&o.add(a)}return o}(this);console.log("Unsupported Dimension type: "+e);break;default:console.log("Unsupported Entity Type: "+JSON.stringify(this.type))}var t,o,r,i,a,c,l,u;return null};const d=u;function y(e,t){if(null==e)return{};var o,n,r=function(e,t){if(null==e)return{};var o,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)o=i[n],t.indexOf(o)>=0||(r[o]=e[o]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)o=i[n],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(r[o]=e[o])}return r}function m(e,t,o,r,s){var p=this.scene=new n.Scene;d.prototype.source=e,d.prototype.font=s,d.prototype.scene=p;for(var a={min:{x:!1,y:!1,z:!1},max:{x:!1,y:!1,z:!1}},c=0;c<e.entities.length;c++){var l=e.entities[c],h=l.type,u=y(l,["type"]),m=new d(h,u).entity;if(m){var f=(new n.Box3).setFromObject(m);f.min.x&&(!1===a.min.x||a.min.x>f.min.x)&&(a.min.x=f.min.x),f.min.y&&(!1===a.min.y||a.min.y>f.min.y)&&(a.min.y=f.min.y),f.min.z&&(!1===a.min.z||a.min.z>f.min.z)&&(a.min.z=f.min.z),f.max.x&&(!1===a.max.x||a.max.x<f.max.x)&&(a.max.x=f.max.x),f.max.y&&(!1===a.max.y||a.max.y<f.max.y)&&(a.max.y=f.max.y),f.max.z&&(!1===a.max.z||a.max.z<f.max.z)&&(a.max.z=f.max.z),p.add(m)}}var v=o||t.clientWidth,x=r||t.clientHeight,b=v/x,g=a.max.x,w=a.max.y,E=a.min.x,P=a.min.y,j=g-E,M=w-P,O=O||{x:j/2+E,y:M/2+P};b>Math.abs(j/M)?j=M*b:M=j/b;var S={bottom:-M/2,left:-j/2,top:M/2,right:j/2,center:{x:O.x,y:O.y}},z=this.camera=new n.OrthographicCamera(S.left,S.right,S.top,S.bottom,1,19);z.position.z=10,z.position.x=S.center.x,z.position.y=S.center.y;var L=this.renderer=new n.WebGLRenderer;L.setSize(v,x),L.setClearColor(268435455,1),t.appendChild(L.domElement),t.style.display="block";var V=new i(z,t);V.target.x=z.position.x,V.target.y=z.position.y,V.target.z=0,V.zoomSpeed=3,V.addEventListener("change",this.render.bind(this)),this.render(),V.update()}m.prototype.info=function(){console.log(this.renderer.info)},m.prototype.render=function(){this.renderer.render(this.scene,this.camera)},m.prototype.resize=function(e,t){var o=e/this.renderer.domElement.width,n=t/this.renderer.domElement.height;camera.top=n*camera.top,camera.bottom=n*camera.bottom,camera.left=o*camera.left,camera.right=o*camera.right,this.renderer.setSize(e,t),this.renderer.setClearColor(268435455,1),this.render()};const f=m},428:t=>{t.exports=e}},o={};function n(e){if(o[e])return o[e].exports;var r=o[e]={exports:{}};return t[e](r,r.exports,n),r.exports}return n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(831)})()}));